# インタラクティブモードの使い方

## はじめに

Claude Codeの「インタラクティブモード」は、AIと対話しながら開発を進めるメインの作業環境です。この章では、効率的な操作方法、便利なショートカット、そして実践的な使い方のコツを詳しく解説します。

## インタラクティブモードとは

### 基本構造

Claude Codeを起動すると、以下のような画面になります:

```
╭────────────────────────────────────────────────────────────────╮
│ ✻ Welcome to Claude Code!                                      │
│                                                                │
│   /help for help, /status for your current setup              │
│                                                                │
│   cwd: /Users/username/projects/my-app                        │
╰────────────────────────────────────────────────────────────────╯

 ※ Tip: Use /permissions to pre-approve and pre-deny bash, edit, and MCP tools

╭────────────────────────────────────────────────────────────────╮
│ > Try "create a util logging.py that..."                      │
╰────────────────────────────────────────────────────────────────╯
  ? for shortcuts
```

**構成要素**
- **ヘッダー**: ウェルカムメッセージと現在のディレクトリ
- **ヒント**: 便利な機能の紹介
- **入力ボックス**: `>` の後にメッセージを入力
- **ショートカットヘルプ**: `?` でショートカット一覧表示

### 入力エリアの理解

```
╭────────────────────────────────────────────────────────────────╮
│ > ここにメッセージを入力                                          │
╰────────────────────────────────────────────────────────────────╯
  ? for shortcuts
```

- `>` 記号: プロンプト（入力待ち状態）
- カーソル: 現在の入力位置
- 枠線: 入力可能な領域

## 基本操作 - キーボードショートカット

### メッセージの入力と送信

**Enter: メッセージを送信**

```bash
> HTMLでシンプルなボタンを作って
[Enter]
```

押した瞬間にメッセージが送信され、Claude Codeが処理を開始します。

**改行の入力方法**

長いメッセージや複数行のコードを含める場合、改行が必要です:

**方法1: バックスラッシュ + Enter**

```bash
> 以下の要件でフォームを作成してください:\
- 名前入力欄（必須）\
- メール入力欄（必須、バリデーション付き）\
- 送信ボタン
[Enter]
```

バックスラッシュ（`\`）の後にEnterを押すと改行され、送信されません。

**方法2: Shift + Enter（設定が必要）**

`/terminal-setup`を実行済みの場合:

```bash
> 以下の要件でフォームを作成してください:
[Shift+Enter]
- 名前入力欄（必須）
[Shift+Enter]
- メール入力欄（必須、バリデーション付き）
[Shift+Enter]
- 送信ボタン
[Enter]
```

**方法3: Option/Alt + Enter（macOS）**

ターミナル設定によっては、Option（macOS）やAlt（Windows/Linux）+ Enterで改行できます。

### 操作の中断とキャンセル

**Esc: 現在の処理を中断**

Claude Codeが作業中でも、Escキーで即座に停止できます:

```bash
> 大規模なリファクタリングを実行してください

# Claude Code が処理を開始...
# 間違いに気づいた！

[Esc]

  ⎿  Interrupted by user
```

**Esc × 2: 前のメッセージを編集**

間違ったメッセージを送信してしまった場合:

```bash
> ボタンを赤色で作って

  ⎿  Creating button...

[Esc] [Esc]

# 前のメッセージが再表示され、編集可能になる
> ボタンを赤色で作って|
# カーソルが末尾に

# 修正
> ボタンを青色で作って
[Enter]
```

**Ctrl+C × 2: Claude Codeを終了**

セッションを完全に終了:

```bash
[Ctrl+C]
# 1回目: 確認メッセージ

Really exit? Press Ctrl+C again to confirm, or any other key to cancel.

[Ctrl+C]
# 2回目: 終了

Goodbye!
$
```

1回だけ押すと確認メッセージが出るので、誤操作を防げます。

### 履歴の操作

**十字キー（↑↓）: メッセージ履歴**

過去に送信したメッセージを再利用できます:

```bash
# 現在の入力状態
> |

[↑]
# 直前のメッセージが表示される
> テストを実行してください

[↑]
# さらに前のメッセージ
> パッケージをインストールしてください

[↓]
# 1つ新しいメッセージに戻る
> テストを実行してください

[Enter]
# そのまま再送信、または編集してから送信
```

**使用例: 微調整して再実行**

```bash
> ボタンのサイズを大きくしてください
# 実行...

[↑]
> ボタンのサイズを大きくしてください
# 編集
> ボタンのサイズを小さくしてください
[Enter]
```

### 表示の制御

**Ctrl+R: 長い出力を展開**

Claude Codeが長いコードや結果を生成した場合、省略されることがあります:

```bash
> 100個のダミーデータをJSON形式で生成してください

Claude Code:
[Generated data.json with 100 entries]

... (95 entries omitted) ...

[Ctrl+R]
# 全内容が表示される
```

**Ctrl+L: 画面をクリア（ターミナル標準）**

画面がごちゃごちゃしてきたら:

```bash
[Ctrl+L]
# 画面がクリアされ、最新のプロンプトのみ表示
```

**Note**: これは会話履歴を削除するわけではなく、表示をクリアするだけです。

## モードの切り替え（Shift+Tab）

Claude Codeには3つのモードがあり、Shift+Tabで切り替えられます。

### 1. Normal Mode（通常モード）

**デフォルトのモード**

```
╭────────────────────────────────────────────────────────────────╮
│ >                                                              │
╰────────────────────────────────────────────────────────────────╯
```

**特徴**
- ファイル編集時に確認を求められる
- コマンド実行前に許可が必要
- 最も安全なモード

**使用例**

```bash
> index.htmlを編集してください

Do you want to make this edit to index.html?
❯ 1. Yes
  2. Yes, and don't ask again this session (shift+tab)
  3. No, and tell Claude what to do differently (esc)

# 毎回確認される
```

### 2. Auto-accept edits on（自動承認モード）

**Shift+Tabで切り替え**

```
╭────────────────────────────────────────────────────────────────╮
│ >                                                              │
╰────────────────────────────────────────────────────────────────╯
  ⏵⏵ auto-accept edits on (shift+tab to cycle)
```

**特徴**
- ファイル編集が自動承認される
- 確認ダイアログが表示されない
- 作業が高速化される

**使用例**

```bash
> index.htmlを編集してください

# 確認なしで即座に実行される
[File edited: index.html]
```

**向いている場面**
- 信頼できる環境で作業
- 素早くプロトタイプを作成
- 細かい確認が不要な単純作業

**注意点**
- 予期しない変更が加えられる可能性
- 重要なファイルでは使用を避ける
- Gitでコミット前の状態にしておくと安全

### 3. Plan Mode（計画モード）

**Shift+Tabでさらに切り替え**

```
╭────────────────────────────────────────────────────────────────╮
│ >                                                              │
╰────────────────────────────────────────────────────────────────╯
  ⏸ plan mode on (shift+tab to cycle)
```

**特徴**
- 実行前に「計画」を立てる
- 実際の変更は行わない
- 影響範囲を事前に確認できる

**使用例**

```bash
> ユーザー認証機能を実装してください

# Plan Mode での応答
I'll create a plan for implementing user authentication:

1. Create authentication middleware
   - File: src/middleware/auth.js
   - JWT token validation
   - Error handling

2. Update user model
   - File: src/models/User.js
   - Add password hashing
   - Add authentication methods

3. Create API endpoints
   - File: src/routes/auth.js
   - POST /api/auth/login
   - POST /api/auth/logout
   - POST /api/auth/refresh

4. Update dependencies
   - Install: jsonwebtoken, bcrypt

Do you want me to proceed with this plan?
```

計画を確認してから実行できるため、大きな変更を加える前に安全です。

**向いている場面**
- 大規模なリファクタリング
- 初めての技術スタックで作業
- 影響範囲が不明なとき
- チーム開発で慎重に進めたいとき

**使い方のコツ**

1. Plan Modeで計画を立てる
2. 計画を確認・修正
3. Normal Modeに戻して実行

```bash
# Plan Mode で計画
[Shift+Tab] [Shift+Tab]
> 大規模リファクタリングを実行

# 計画を確認

# Normal Mode に戻る
[Shift+Tab]

# 実行を指示
> 先ほどの計画を実行してください
```

## 実践的な操作パターン

### パターン1: 基本的な対話

```bash
# 要件を伝える
> Reactでログインフォームを作成してください

# Claude Code が作業...

# 確認・修正依頼
> ボタンの色を青にしてください

# さらに調整
> エラーメッセージは赤字で表示してください
```

### パターン2: 段階的な開発

```bash
# Step 1: 計画
[Shift+Tab] [Shift+Tab]  # Plan Mode
> ユーザー管理機能を実装してください

# 計画を確認

# Step 2: 実装
[Shift+Tab]  # Normal Mode
> 先ほどの計画を実装してください

# Step 3: テスト
> テストを実行してください

# Step 4: エラー修正
> テストエラーを修正してください
```

### パターン3: 試行錯誤

```bash
> この関数を最適化してください

# 結果が期待と違った

[Esc]  # 中断

[↑]  # 前のメッセージを呼び出し
> この関数をメモリ効率を重視して最適化してください
[Enter]
```

### パターン4: 複数ファイルの編集

```bash
[Shift+Tab]  # Auto-accept mode
> 以下のファイルをすべて更新:
- Header.jsx: ロゴを追加
- Footer.jsx: コピーライトを更新
- App.jsx: 両方をインポート

# 自動で全て実行される

[Shift+Tab]  # Normal Mode に戻す
```

## 画像の貼り付け

Claude Codeは画像を理解できます。デザインモックから実装を依頼するときに便利です。

### 画像の追加方法

**方法1: ドラッグ&ドロップ（macOS/Linux）**

1. デザイン画像を準備
2. ターミナルに画像をドラッグ
3. Shiftキーを押しながらドロップ

```bash
> [Image #1]
> このデザインを実装してください
[Enter]
```

**方法2: クリップボードから貼り付け（macOS）**

1. スクリーンショットを撮る（Cmd+Shift+4）
2. Claude Codeの入力欄で Ctrl+V

```bash
> [Image #1]
> この画面をReactコンポーネントで実装してください
[Enter]
```

**方法3: ファイルパスを指定**

```bash
> 画像ファイル: ~/Desktop/design-mockup.png
> この画面を実装してください
```

### 画像を使った実践例

```bash
> [Image #1]
> このログイン画面を以下の要件で実装してください:
> - Tailwind CSS使用
> - バリデーションエラー表示
> - パスワード表示/非表示切り替え
> - レスポンシブ対応
[Enter]
```

Claude Codeは画像を解析し、デザインに忠実なコードを生成します。

## Tips: 効率的な使い方

### Tip 1: 明確な指示を出す

**悪い例**

```bash
> ボタンを作って
```

**良い例**

```bash
> 青色の送信ボタンを作成してください。
> サイズは幅200px、高さ40pxで、
> ホバー時に明るくなるアニメーション付き。
> Tailwind CSSを使用してください。
```

### Tip 2: コンテキストを提供

```bash
> このプロジェクトはReact 18とTypeScriptを使用しています。
> ユーザー認証機能を実装してください。
> JWTトークンを使用し、/api/authエンドポイントで認証します。
```

### Tip 3: 段階的に進める

一度に全てを依頼せず、段階的に:

```bash
# Step 1
> まず、基本的なフォームを作成してください

# 確認後、Step 2
> バリデーションを追加してください

# 確認後、Step 3
> 送信後のローディング状態を追加してください
```

### Tip 4: エラーは具体的に伝える

```bash
# 悪い例
> エラーが出ます

# 良い例
> 以下のエラーが出ます:
> TypeError: Cannot read property 'map' of undefined
> このエラーはデータ取得後、dataがundefinedの時に発生しています。
> 修正してください。
```

### Tip 5: 期待する出力を明示

```bash
> この関数のテストを書いてください。
> Jestを使用し、正常系・異常系の両方をカバーしてください。
> 期待する出力: 少なくとも5つのテストケース。
```

## よくある質問

### Q1: 長い会話になってきたら？

```bash
> /compact
# または
> /clear
```

`/compact`は会話を要約してトークン節約、`/clear`は完全にリセット。

### Q2: 間違った指示を送ってしまった

```bash
[Esc] [Esc]
# 前のメッセージが編集可能に
```

### Q3: Claude Codeが止まらない

```bash
[Esc]
# 即座に中断
```

### Q4: 確認ダイアログが多すぎる

```bash
[Shift+Tab]
# Auto-accept mode に切り替え
```

または、設定で特定の操作を自動承認（後の章で解説）。

## まとめ

インタラクティブモードの重要な操作:

**基本操作**
- **Enter**: 送信
- **\ + Enter**: 改行
- **Esc**: 中断
- **Esc × 2**: 前のメッセージを編集
- **Ctrl+C × 2**: 終了
- **十字キー（↑↓）**: 履歴

**モード切り替え（Shift+Tab）**
- **Normal**: 安全（確認あり）
- **Auto-accept**: 高速（確認なし）
- **Plan**: 計画優先

**効率化のコツ**
- 明確な指示
- 段階的な進行
- コンテキストの提供
- エラーは具体的に

次章では、よく使うスラッシュコマンドについて詳しく学びます。
